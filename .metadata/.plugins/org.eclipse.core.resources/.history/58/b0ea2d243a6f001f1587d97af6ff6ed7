package 하성;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

public class JDBCCharge_ListDao implements ChargeDao {

	@Override
	public boolean insert(Charge chargeList) {
		boolean result = false;
		
		try(Connection connection = DataSource.getDataSource();
				PreparedStatement pStatement 
					= connection.prepareStatement("INSERT INTO CHARGE (CHARGE_NUM,PERIOD,PT_COUNT)"
							+ " VALUES (?, ?, ?)")) {
			
			pStatement.setInt(1, chargeList.getCharge_num());
			pStatement.setDate(2, chargeList.getPeriod());
			pStatement.setInt(3, chargeList.getPt_count());
			
			int rows = pStatement.executeUpdate();
			
			if(rows > 0) {
				result = true;
			}
			
		}	catch(SQLException e) {
			e.printStackTrace();
		}
		
		return result;
	}

	@Override
	public List<Charge> findAll() {
		
	}

	@Override
	public Charge findByManager_num(int num) {
		Charge charge = null;

		try(Connection connection = DataSource.getDataSource();
				PreparedStatement pStatement
					= connection.prepareStatement("SELECT * FROM CHARGE WHERE CHARGE_NUM = ?")){
			
			pStatement.setInt(1, num);
			ResultSet rs = pStatement.executeQuery();
			
			if(rs.next()) {
				charge = new Charge();
					
				charge.setCharge_num(rs.getInt("charge_num"));
				charge.setPeriod(rs.getDate("period"));
				charge.setPt_count(rs.getInt("pt_count"));
			}
			
			}catch(SQLException e) {
				e.printStackTrace();
			}
			return charge;	
		}

	@Override
	public boolean update(Charge chargeList) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean deleteByCharge_Num(int chargeList) {
		// TODO Auto-generated method stub
		return false;
	}
	
}
